
SELECT users.id, users.first_name, users.last_name, COUNT(purchase.id) AS total_purchases
        FROM users
        LEFT JOIN purchase ON users.id = purchase.user_id
        GROUP BY users.id